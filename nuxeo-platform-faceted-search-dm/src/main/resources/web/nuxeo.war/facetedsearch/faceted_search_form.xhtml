<div xmlns:h="http://java.sun.com/jsf/html"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:a4j="http://richfaces.org/a4j"
  xmlns:nxl="http://nuxeo.org/nxforms/layout"
  class="compactLayout">

  <h:form id="facetedSearchSaveForm">
    <nxl:widget name="facetedSaveSearch" mode="view" />
  </h:form>

  <h:form id="facetedSearchSelectorForm">
    <nxl:layout name="faceted_search_default_selectors"
      mode="search" value="#{contentView.searchDocumentModel}"/>
  </h:form>

  <h:form id="facetedSearchForm">

    <nxu:set var="contentViewName"
      value="#{facetedSearchActions.currentContentViewName}">

      <div style="display:none;">
        <h:commandButton action="faceted_search_results">
          <nxu:actionListenerMethod
            value="#{contentViewActions.refreshAndRewind(contentViewName)}"/>
        </h:commandButton>
      </div>

      <nxu:set var="contentView"
        value="#{contentViewActions.getContentViewWithProvider(contentViewName)}"
        cache="true">
        <c:if test="#{contentView != null}">

          <div class="facetedSearchBlock">
            <nxl:layout name="faceted_search_default_actions"
              mode="search" value="#{contentView.searchDocumentModel}"/>
            <nxl:layout name="#{contentView.searchLayout.name}" mode="search"
              value="#{contentView.searchDocumentModel}"/>
            <nxl:layout name="faceted_search_default_actions"
              mode="search" value="#{contentView.searchDocumentModel}"/>
          </div>

        </c:if>
      </nxu:set>

    </nxu:set>
  </h:form>

</div>

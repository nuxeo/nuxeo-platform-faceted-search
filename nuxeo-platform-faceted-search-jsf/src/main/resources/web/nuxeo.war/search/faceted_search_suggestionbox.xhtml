<div xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax"
  xmlns:nxu="http://nuxeo.org/nxweb/util"
  xmlns:nxdir="http://nuxeo.org/nxdirectory"
  xmlns:cm="http://org.nuxeo.cm/" xmlns:rich="http://richfaces.org/rich"
  xmlns:nxl="http://nuxeo.org/nxforms/layout"
  style="display: inline; float: left">

  <c:set var="minChars"
    value="#{nxu:test(!empty widget.properties.minChars, widget.properties.minChars, '1')}" />
  <c:set var="frequency"
    value="#{nxu:test(!empty widget.properties.frequency, widget.properties.frequency, '0')}" />
  <c:set var="requestDelay"
    value="#{nxu:test(!empty widget.properties.requestDelay, widget.properties.requestDelay, '100')}" />

  <a4j:region renderRegionOnly="true">
    <h:panelGrid id="#{widget.id}_mailbox_panel" columns="3">
      <h:panelGroup>
        <a4j:status>
          <f:facet name="start">
            <h:graphicImage value="/img/standart_waiter.gif" />
          </f:facet>
        </a4j:status>
        <h:inputText id="faceted_search_suggest_box"
            class="faceted_search_suggest_box"
            onkeydown="if (event.keyCode == 13) {return false;}"
            value="#{facetedSearchSuggestionActions.searchKeywords}" />
        <script type="text/javascript">
        <!--
         jQuery(document).bind('keypress', '/', function() {
            jQuery('input.faceted_search_suggest_box').focus();
         });
        -->
        </script>
        <rich:suggestionbox
          id="faceted_search_suggestionBox"
          for="faceted_search_suggest_box" tokens=""
          suggestionAction="#{facetedSearchSuggestionActions.getSuggestions}"
          var="result" fetchValue="" width="300"
          nothingLabel="Search with key words" minChars="#{minChars}"
          frequency="#{frequency}" requestDelay="#{requestDelay}">
          <f:param name="facetedSuggestionSearchType"
            value="#{widget.properties['facetedSuggestionSearchType']}" />
          <a4j:support event="onselect" id="#{widget.id}_a4jSupport"
            focus="" bypassUpdates="true" reRender=""
            action="#{facetedSearchSuggestionActions.handleSelection(result.type,result.value)}">
          </a4j:support>
          <h:column>
            <h:graphicImage value="#{result.iconURL}" />
          </h:column>
          <h:column>
            <h:outputText value="#{result.label}" />
          </h:column>
        </rich:suggestionbox>
        <h:commandButton
          action="#{facetedSearchSuggestionActions.performKerwordsSearch}"
          value="#{messages['command.search']}" styleClass="button"
          id="simpleSearchSubmitButton" />
      </h:panelGroup>

    </h:panelGrid>

  </a4j:region>

</div>
